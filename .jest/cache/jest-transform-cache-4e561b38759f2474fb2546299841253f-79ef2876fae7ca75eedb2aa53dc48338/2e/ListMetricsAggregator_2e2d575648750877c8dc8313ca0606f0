ca69da2b8fe6038997eef1beea254e9f
var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _classCallCheck2 = _interopRequireDefault(require("@babel/runtime/helpers/classCallCheck"));
var _createClass2 = _interopRequireDefault(require("@babel/runtime/helpers/createClass"));
var _VirtualizeUtils = require("./VirtualizeUtils");
var _invariant = _interopRequireDefault(require("invariant"));
var ListMetricsAggregator = exports.default = function () {
  function ListMetricsAggregator() {
    (0, _classCallCheck2.default)(this, ListMetricsAggregator);
    this._averageCellLength = 0;
    this._cellMetrics = new Map();
    this._highestMeasuredCellIndex = 0;
    this._measuredCellsLength = 0;
    this._measuredCellsCount = 0;
    this._orientation = {
      horizontal: false,
      rtl: false
    };
  }
  return (0, _createClass2.default)(ListMetricsAggregator, [{
    key: "notifyCellLayout",
    value: function notifyCellLayout(_ref) {
      var cellIndex = _ref.cellIndex,
        cellKey = _ref.cellKey,
        orientation = _ref.orientation,
        layout = _ref.layout;
      this._invalidateIfOrientationChanged(orientation);
      var next = {
        index: cellIndex,
        length: this._selectLength(layout),
        isMounted: true,
        offset: this.flowRelativeOffset(layout)
      };
      var curr = this._cellMetrics.get(cellKey);
      if (!curr || next.offset !== curr.offset || next.length !== curr.length) {
        if (curr) {
          var dLength = next.length - curr.length;
          this._measuredCellsLength += dLength;
        } else {
          this._measuredCellsLength += next.length;
          this._measuredCellsCount += 1;
        }
        this._averageCellLength = this._measuredCellsLength / this._measuredCellsCount;
        this._cellMetrics.set(cellKey, next);
        this._highestMeasuredCellIndex = Math.max(this._highestMeasuredCellIndex, cellIndex);
        return true;
      } else {
        curr.isMounted = true;
        return false;
      }
    }
  }, {
    key: "notifyCellUnmounted",
    value: function notifyCellUnmounted(cellKey) {
      var curr = this._cellMetrics.get(cellKey);
      if (curr) {
        curr.isMounted = false;
      }
    }
  }, {
    key: "notifyListContentLayout",
    value: function notifyListContentLayout(_ref2) {
      var orientation = _ref2.orientation,
        layout = _ref2.layout;
      this._invalidateIfOrientationChanged(orientation);
      this._contentLength = this._selectLength(layout);
    }
  }, {
    key: "getAverageCellLength",
    value: function getAverageCellLength() {
      return this._averageCellLength;
    }
  }, {
    key: "getHighestMeasuredCellIndex",
    value: function getHighestMeasuredCellIndex() {
      return this._highestMeasuredCellIndex;
    }
  }, {
    key: "getCellMetricsApprox",
    value: function getCellMetricsApprox(index, props) {
      var frame = this.getCellMetrics(index, props);
      if (frame && frame.index === index) {
        return frame;
      } else {
        var offset;
        var highestMeasuredCellIndex = this.getHighestMeasuredCellIndex();
        if (highestMeasuredCellIndex < index) {
          var highestMeasuredCellFrame = this.getCellMetrics(highestMeasuredCellIndex, props);
          if (highestMeasuredCellFrame) {
            offset = highestMeasuredCellFrame.offset + highestMeasuredCellFrame.length + this._averageCellLength * (index - highestMeasuredCellIndex - 1);
          }
        }
        if (offset == null) {
          offset = this._averageCellLength * index;
        }
        var data = props.data,
          getItemCount = props.getItemCount;
        (0, _invariant.default)(index >= 0 && index < getItemCount(data), 'Tried to get frame for out of range index ' + index);
        return {
          length: this._averageCellLength,
          offset: offset,
          index: index,
          isMounted: false
        };
      }
    }
  }, {
    key: "getCellMetrics",
    value: function getCellMetrics(index, props) {
      var _props$keyExtractor;
      var data = props.data,
        getItem = props.getItem,
        getItemCount = props.getItemCount,
        getItemLayout = props.getItemLayout;
      (0, _invariant.default)(index >= 0 && index < getItemCount(data), 'Tried to get metrics for out of range cell index ' + index);
      var keyExtractor = (_props$keyExtractor = props.keyExtractor) != null ? _props$keyExtractor : _VirtualizeUtils.keyExtractor;
      var frame = this._cellMetrics.get(keyExtractor(getItem(data, index), index));
      if (frame && frame.index === index) {
        return frame;
      }
      if (getItemLayout) {
        var _getItemLayout = getItemLayout(data, index),
          length = _getItemLayout.length,
          offset = _getItemLayout.offset;
        return {
          index: index,
          length: length,
          offset: offset,
          isMounted: true
        };
      }
      return null;
    }
  }, {
    key: "getCellOffsetApprox",
    value: function getCellOffsetApprox(index, props) {
      if (Number.isInteger(index)) {
        return this.getCellMetricsApprox(index, props).offset;
      } else {
        var frameMetrics = this.getCellMetricsApprox(Math.floor(index), props);
        var remainder = index - Math.floor(index);
        return frameMetrics.offset + remainder * frameMetrics.length;
      }
    }
  }, {
    key: "getContentLength",
    value: function getContentLength() {
      var _this$_contentLength;
      return (_this$_contentLength = this._contentLength) != null ? _this$_contentLength : 0;
    }
  }, {
    key: "hasContentLength",
    value: function hasContentLength() {
      return this._contentLength != null;
    }
  }, {
    key: "flowRelativeOffset",
    value: function flowRelativeOffset(layout, referenceContentLength) {
      var _this$_orientation = this._orientation,
        horizontal = _this$_orientation.horizontal,
        rtl = _this$_orientation.rtl;
      if (horizontal && rtl) {
        var contentLength = referenceContentLength != null ? referenceContentLength : this._contentLength;
        (0, _invariant.default)(contentLength != null, 'ListMetricsAggregator must be notified of list content layout before resolving offsets');
        return contentLength - (this._selectOffset(layout) + this._selectLength(layout));
      } else {
        return this._selectOffset(layout);
      }
    }
  }, {
    key: "cartesianOffset",
    value: function cartesianOffset(flowRelativeOffset) {
      var _this$_orientation2 = this._orientation,
        horizontal = _this$_orientation2.horizontal,
        rtl = _this$_orientation2.rtl;
      if (horizontal && rtl) {
        (0, _invariant.default)(this._contentLength != null, 'ListMetricsAggregator must be notified of list content layout before resolving offsets');
        return this._contentLength - flowRelativeOffset;
      } else {
        return flowRelativeOffset;
      }
    }
  }, {
    key: "_invalidateIfOrientationChanged",
    value: function _invalidateIfOrientationChanged(orientation) {
      if (orientation.rtl !== this._orientation.rtl) {
        this._cellMetrics.clear();
      }
      if (orientation.horizontal !== this._orientation.horizontal) {
        this._averageCellLength = 0;
        this._highestMeasuredCellIndex = 0;
        this._measuredCellsLength = 0;
        this._measuredCellsCount = 0;
      }
      this._orientation = orientation;
    }
  }, {
    key: "_selectLength",
    value: function _selectLength(_ref3) {
      var width = _ref3.width,
        height = _ref3.height;
      return this._orientation.horizontal ? width : height;
    }
  }, {
    key: "_selectOffset",
    value: function _selectOffset(_ref4) {
      var x = _ref4.x,
        y = _ref4.y;
      return this._orientation.horizontal ? x : y;
    }
  }]);
}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfVmlydHVhbGl6ZVV0aWxzIiwicmVxdWlyZSIsIl9pbnZhcmlhbnQiLCJfaW50ZXJvcFJlcXVpcmVEZWZhdWx0IiwiTGlzdE1ldHJpY3NBZ2dyZWdhdG9yIiwiZXhwb3J0cyIsImRlZmF1bHQiLCJfY2xhc3NDYWxsQ2hlY2syIiwiX2F2ZXJhZ2VDZWxsTGVuZ3RoIiwiX2NlbGxNZXRyaWNzIiwiTWFwIiwiX2hpZ2hlc3RNZWFzdXJlZENlbGxJbmRleCIsIl9tZWFzdXJlZENlbGxzTGVuZ3RoIiwiX21lYXN1cmVkQ2VsbHNDb3VudCIsIl9vcmllbnRhdGlvbiIsImhvcml6b250YWwiLCJydGwiLCJfY3JlYXRlQ2xhc3MyIiwia2V5IiwidmFsdWUiLCJub3RpZnlDZWxsTGF5b3V0IiwiX3JlZiIsImNlbGxJbmRleCIsImNlbGxLZXkiLCJvcmllbnRhdGlvbiIsImxheW91dCIsIl9pbnZhbGlkYXRlSWZPcmllbnRhdGlvbkNoYW5nZWQiLCJuZXh0IiwiaW5kZXgiLCJsZW5ndGgiLCJfc2VsZWN0TGVuZ3RoIiwiaXNNb3VudGVkIiwib2Zmc2V0IiwiZmxvd1JlbGF0aXZlT2Zmc2V0IiwiY3VyciIsImdldCIsImRMZW5ndGgiLCJzZXQiLCJNYXRoIiwibWF4Iiwibm90aWZ5Q2VsbFVubW91bnRlZCIsIm5vdGlmeUxpc3RDb250ZW50TGF5b3V0IiwiX3JlZjIiLCJfY29udGVudExlbmd0aCIsImdldEF2ZXJhZ2VDZWxsTGVuZ3RoIiwiZ2V0SGlnaGVzdE1lYXN1cmVkQ2VsbEluZGV4IiwiZ2V0Q2VsbE1ldHJpY3NBcHByb3giLCJwcm9wcyIsImZyYW1lIiwiZ2V0Q2VsbE1ldHJpY3MiLCJoaWdoZXN0TWVhc3VyZWRDZWxsSW5kZXgiLCJoaWdoZXN0TWVhc3VyZWRDZWxsRnJhbWUiLCJkYXRhIiwiZ2V0SXRlbUNvdW50IiwiaW52YXJpYW50IiwiX3Byb3BzJGtleUV4dHJhY3RvciIsImdldEl0ZW0iLCJnZXRJdGVtTGF5b3V0Iiwia2V5RXh0cmFjdG9yIiwiZGVmYXVsdEtleUV4dHJhY3RvciIsIl9nZXRJdGVtTGF5b3V0IiwiZ2V0Q2VsbE9mZnNldEFwcHJveCIsIk51bWJlciIsImlzSW50ZWdlciIsImZyYW1lTWV0cmljcyIsImZsb29yIiwicmVtYWluZGVyIiwiZ2V0Q29udGVudExlbmd0aCIsIl90aGlzJF9jb250ZW50TGVuZ3RoIiwiaGFzQ29udGVudExlbmd0aCIsInJlZmVyZW5jZUNvbnRlbnRMZW5ndGgiLCJfdGhpcyRfb3JpZW50YXRpb24iLCJjb250ZW50TGVuZ3RoIiwiX3NlbGVjdE9mZnNldCIsImNhcnRlc2lhbk9mZnNldCIsIl90aGlzJF9vcmllbnRhdGlvbjIiLCJjbGVhciIsIl9yZWYzIiwid2lkdGgiLCJoZWlnaHQiLCJfcmVmNCIsIngiLCJ5Il0sInNvdXJjZXMiOlsiTGlzdE1ldHJpY3NBZ2dyZWdhdG9yLmpzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogQ29weXJpZ2h0IChjKSBNZXRhIFBsYXRmb3JtcywgSW5jLiBhbmQgYWZmaWxpYXRlcy5cbiAqXG4gKiBUaGlzIHNvdXJjZSBjb2RlIGlzIGxpY2Vuc2VkIHVuZGVyIHRoZSBNSVQgbGljZW5zZSBmb3VuZCBpbiB0aGVcbiAqIExJQ0VOU0UgZmlsZSBpbiB0aGUgcm9vdCBkaXJlY3Rvcnkgb2YgdGhpcyBzb3VyY2UgdHJlZS5cbiAqXG4gKiBAZmxvdyBzdHJpY3QtbG9jYWxcbiAqIEBmb3JtYXRcbiAqL1xuXG5pbXBvcnQgdHlwZSB7VmlydHVhbGl6ZWRMaXN0UHJvcHN9IGZyb20gJy4vVmlydHVhbGl6ZWRMaXN0UHJvcHMnO1xuaW1wb3J0IHR5cGUge0xheW91dFJlY3RhbmdsZX0gZnJvbSAncmVhY3QtbmF0aXZlJztcblxuaW1wb3J0IHtrZXlFeHRyYWN0b3IgYXMgZGVmYXVsdEtleUV4dHJhY3Rvcn0gZnJvbSAnLi9WaXJ0dWFsaXplVXRpbHMnO1xuaW1wb3J0IGludmFyaWFudCBmcm9tICdpbnZhcmlhbnQnO1xuXG5leHBvcnQgdHlwZSBDZWxsTWV0cmljcyA9IHtcbiAgLyoqXG4gICAqIEluZGV4IG9mIHRoZSBpdGVtIGluIHRoZSBsaXN0XG4gICAqL1xuICBpbmRleDogbnVtYmVyLFxuICAvKipcbiAgICogTGVuZ3RoIG9mIHRoZSBjZWxsIGFsb25nIHRoZSBzY3JvbGxpbmcgYXhpc1xuICAgKi9cbiAgbGVuZ3RoOiBudW1iZXIsXG4gIC8qKlxuICAgKiBEaXN0YW5jZSBiZXR3ZWVuIHRoaXMgY2VsbCBhbmQgdGhlIHN0YXJ0IG9mIHRoZSBsaXN0IGFsb25nIHRoZSBzY3JvbGxpbmdcbiAgICogYXhpc1xuICAgKi9cbiAgb2Zmc2V0OiBudW1iZXIsXG4gIC8qKlxuICAgKiBXaGV0aGVyIHRoZSBjZWxsIGlzIGxhc3Qga25vd24gdG8gYmUgbW91bnRlZFxuICAgKi9cbiAgaXNNb3VudGVkOiBib29sZWFuLFxufTtcblxuLy8gVE9ETzogYGludmVydGVkYCBjYW4gYmUgaW5jb3Jwb3JhdGVkIGhlcmUgaWYgaXQgaXMgbW92ZWQgdG8gYW4gb3JkZXJcbi8vIGJhc2VkIGltcGxlbWVudGF0aW9uIGluc3RlYWQgb2YgdHJhbnNmb3JtLlxuZXhwb3J0IHR5cGUgTGlzdE9yaWVudGF0aW9uID0ge1xuICBob3Jpem9udGFsOiBib29sZWFuLFxuICBydGw6IGJvb2xlYW4sXG59O1xuXG4vKipcbiAqIFN1YnNldCBvZiBWaXJ0dWFsaXplZExpc3QgcHJvcHMgbmVlZGVkIHRvIGNhbGN1bGF0ZSBjZWxsIG1ldHJpY3NcbiAqL1xuZXhwb3J0IHR5cGUgQ2VsbE1ldHJpY1Byb3BzID0ge1xuICBkYXRhOiBWaXJ0dWFsaXplZExpc3RQcm9wc1snZGF0YSddLFxuICBnZXRJdGVtQ291bnQ6IFZpcnR1YWxpemVkTGlzdFByb3BzWydnZXRJdGVtQ291bnQnXSxcbiAgZ2V0SXRlbTogVmlydHVhbGl6ZWRMaXN0UHJvcHNbJ2dldEl0ZW0nXSxcbiAgZ2V0SXRlbUxheW91dD86IFZpcnR1YWxpemVkTGlzdFByb3BzWydnZXRJdGVtTGF5b3V0J10sXG4gIGtleUV4dHJhY3Rvcj86IFZpcnR1YWxpemVkTGlzdFByb3BzWydrZXlFeHRyYWN0b3InXSxcbiAgLi4uXG59O1xuXG4vKipcbiAqIFByb3ZpZGVzIGFuIGludGVyZmFjZSB0byBxdWVyeSBpbmZvcm1hdGlvbiBhYm91dCB0aGUgbWV0cmljcyBvZiBhIGxpc3QgYW5kIGl0cyBjZWxscy5cbiAqL1xuZXhwb3J0IGRlZmF1bHQgY2xhc3MgTGlzdE1ldHJpY3NBZ2dyZWdhdG9yIHtcbiAgX2F2ZXJhZ2VDZWxsTGVuZ3RoID0gMDtcbiAgX2NlbGxNZXRyaWNzOiBNYXA8c3RyaW5nLCBDZWxsTWV0cmljcz4gPSBuZXcgTWFwKCk7XG4gIF9jb250ZW50TGVuZ3RoOiA/bnVtYmVyO1xuICBfaGlnaGVzdE1lYXN1cmVkQ2VsbEluZGV4ID0gMDtcbiAgX21lYXN1cmVkQ2VsbHNMZW5ndGggPSAwO1xuICBfbWVhc3VyZWRDZWxsc0NvdW50ID0gMDtcbiAgX29yaWVudGF0aW9uOiBMaXN0T3JpZW50YXRpb24gPSB7XG4gICAgaG9yaXpvbnRhbDogZmFsc2UsXG4gICAgcnRsOiBmYWxzZSxcbiAgfTtcblxuICAvKipcbiAgICogTm90aWZ5IHRoZSBMaXN0TWV0cmljc0FnZ3JlZ2F0b3IgdGhhdCBhIGNlbGwgaGFzIGJlZW4gbGFpZCBvdXQuXG4gICAqXG4gICAqIEByZXR1cm5zIHdoZXRoZXIgdGhlIGNlbGwgbGF5b3V0IGhhcyBjaGFuZ2VkIHNpbmNlIGxhc3Qgbm90aWZpY2F0aW9uXG4gICAqL1xuICBub3RpZnlDZWxsTGF5b3V0KHtcbiAgICBjZWxsSW5kZXgsXG4gICAgY2VsbEtleSxcbiAgICBvcmllbnRhdGlvbixcbiAgICBsYXlvdXQsXG4gIH06IHtcbiAgICBjZWxsSW5kZXg6IG51bWJlcixcbiAgICBjZWxsS2V5OiBzdHJpbmcsXG4gICAgb3JpZW50YXRpb246IExpc3RPcmllbnRhdGlvbixcbiAgICBsYXlvdXQ6IExheW91dFJlY3RhbmdsZSxcbiAgfSk6IGJvb2xlYW4ge1xuICAgIHRoaXMuX2ludmFsaWRhdGVJZk9yaWVudGF0aW9uQ2hhbmdlZChvcmllbnRhdGlvbik7XG5cbiAgICBjb25zdCBuZXh0OiBDZWxsTWV0cmljcyA9IHtcbiAgICAgIGluZGV4OiBjZWxsSW5kZXgsXG4gICAgICBsZW5ndGg6IHRoaXMuX3NlbGVjdExlbmd0aChsYXlvdXQpLFxuICAgICAgaXNNb3VudGVkOiB0cnVlLFxuICAgICAgb2Zmc2V0OiB0aGlzLmZsb3dSZWxhdGl2ZU9mZnNldChsYXlvdXQpLFxuICAgIH07XG4gICAgY29uc3QgY3VyciA9IHRoaXMuX2NlbGxNZXRyaWNzLmdldChjZWxsS2V5KTtcblxuICAgIGlmICghY3VyciB8fCBuZXh0Lm9mZnNldCAhPT0gY3Vyci5vZmZzZXQgfHwgbmV4dC5sZW5ndGggIT09IGN1cnIubGVuZ3RoKSB7XG4gICAgICBpZiAoY3Vycikge1xuICAgICAgICBjb25zdCBkTGVuZ3RoID0gbmV4dC5sZW5ndGggLSBjdXJyLmxlbmd0aDtcbiAgICAgICAgdGhpcy5fbWVhc3VyZWRDZWxsc0xlbmd0aCArPSBkTGVuZ3RoO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5fbWVhc3VyZWRDZWxsc0xlbmd0aCArPSBuZXh0Lmxlbmd0aDtcbiAgICAgICAgdGhpcy5fbWVhc3VyZWRDZWxsc0NvdW50ICs9IDE7XG4gICAgICB9XG5cbiAgICAgIHRoaXMuX2F2ZXJhZ2VDZWxsTGVuZ3RoID1cbiAgICAgICAgdGhpcy5fbWVhc3VyZWRDZWxsc0xlbmd0aCAvIHRoaXMuX21lYXN1cmVkQ2VsbHNDb3VudDtcbiAgICAgIHRoaXMuX2NlbGxNZXRyaWNzLnNldChjZWxsS2V5LCBuZXh0KTtcbiAgICAgIHRoaXMuX2hpZ2hlc3RNZWFzdXJlZENlbGxJbmRleCA9IE1hdGgubWF4KFxuICAgICAgICB0aGlzLl9oaWdoZXN0TWVhc3VyZWRDZWxsSW5kZXgsXG4gICAgICAgIGNlbGxJbmRleCxcbiAgICAgICk7XG4gICAgICByZXR1cm4gdHJ1ZTtcbiAgICB9IGVsc2Uge1xuICAgICAgY3Vyci5pc01vdW50ZWQgPSB0cnVlO1xuICAgICAgcmV0dXJuIGZhbHNlO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBOb3RpZnkgTGlzdE1ldHJpY3NBZ2dyZWdhdG9yIHRoYXQgYSBjZWxsIGhhcyBiZWVuIHVubW91bnRlZC5cbiAgICovXG4gIG5vdGlmeUNlbGxVbm1vdW50ZWQoY2VsbEtleTogc3RyaW5nKTogdm9pZCB7XG4gICAgY29uc3QgY3VyciA9IHRoaXMuX2NlbGxNZXRyaWNzLmdldChjZWxsS2V5KTtcbiAgICBpZiAoY3Vycikge1xuICAgICAgY3Vyci5pc01vdW50ZWQgPSBmYWxzZTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogTm90aWZ5IExpc3RNZXRyaWNzQWdncmVnYXRvciB0aGF0IHRoZSBsaXN0cyBjb250ZW50IGNvbnRhaW5lciBoYXMgYmVlbiBsYWlkIG91dC5cbiAgICovXG4gIG5vdGlmeUxpc3RDb250ZW50TGF5b3V0KHtcbiAgICBvcmllbnRhdGlvbixcbiAgICBsYXlvdXQsXG4gIH06IHtcbiAgICBvcmllbnRhdGlvbjogTGlzdE9yaWVudGF0aW9uLFxuICAgIGxheW91dDogJFJlYWRPbmx5PHt3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcn0+LFxuICB9KTogdm9pZCB7XG4gICAgdGhpcy5faW52YWxpZGF0ZUlmT3JpZW50YXRpb25DaGFuZ2VkKG9yaWVudGF0aW9uKTtcbiAgICB0aGlzLl9jb250ZW50TGVuZ3RoID0gdGhpcy5fc2VsZWN0TGVuZ3RoKGxheW91dCk7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJuIHRoZSBhdmVyYWdlIGxlbmd0aCBvZiB0aGUgY2VsbHMgd2hpY2ggaGF2ZSBiZWVuIG1lYXN1cmVkXG4gICAqL1xuICBnZXRBdmVyYWdlQ2VsbExlbmd0aCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9hdmVyYWdlQ2VsbExlbmd0aDtcbiAgfVxuXG4gIC8qKlxuICAgKiBSZXR1cm4gdGhlIGhpZ2hlc3QgbWVhc3VyZWQgY2VsbCBpbmRleCAob3IgMCBpZiBub3RoaW5nIGhhcyBiZWVuIG1lYXN1cmVkXG4gICAqIHlldClcbiAgICovXG4gIGdldEhpZ2hlc3RNZWFzdXJlZENlbGxJbmRleCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9oaWdoZXN0TWVhc3VyZWRDZWxsSW5kZXg7XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgZXhhY3QgbWV0cmljcyBvZiBhIGNlbGwgaWYgaXQgaGFzIGFscmVhZHkgYmVlbiBsYWlkIG91dCxcbiAgICogb3RoZXJ3aXNlIGFuIGVzdGltYXRlIGJhc2VkIG9uIHRoZSBhdmVyYWdlIGxlbmd0aCBvZiBwcmV2aW91c2x5IG1lYXN1cmVkXG4gICAqIGNlbGxzXG4gICAqL1xuICBnZXRDZWxsTWV0cmljc0FwcHJveChpbmRleDogbnVtYmVyLCBwcm9wczogQ2VsbE1ldHJpY1Byb3BzKTogQ2VsbE1ldHJpY3Mge1xuICAgIGNvbnN0IGZyYW1lID0gdGhpcy5nZXRDZWxsTWV0cmljcyhpbmRleCwgcHJvcHMpO1xuICAgIGlmIChmcmFtZSAmJiBmcmFtZS5pbmRleCA9PT0gaW5kZXgpIHtcbiAgICAgIC8vIGNoZWNrIGZvciBpbnZhbGlkIGZyYW1lcyBkdWUgdG8gcm93IHJlLW9yZGVyaW5nXG4gICAgICByZXR1cm4gZnJhbWU7XG4gICAgfSBlbHNlIHtcbiAgICAgIGxldCBvZmZzZXQ7XG5cbiAgICAgIGNvbnN0IGhpZ2hlc3RNZWFzdXJlZENlbGxJbmRleCA9IHRoaXMuZ2V0SGlnaGVzdE1lYXN1cmVkQ2VsbEluZGV4KCk7XG4gICAgICBpZiAoaGlnaGVzdE1lYXN1cmVkQ2VsbEluZGV4IDwgaW5kZXgpIHtcbiAgICAgICAgLy8gSWYgYW55IG9mIHRoZSBjZWxscyBiZWZvcmUgdGhpcyBvbmUgaGF2ZSBiZWVuIGxhaWQgb3V0IGFscmVhZHksIHdlXG4gICAgICAgIC8vIHNob3VsZCB1c2UgdGhhdCBpbmZvcm1hdGlvbiBpbiB0aGUgZXN0aW1hdGlvbnMuXG4gICAgICAgIC8vIFRoaXMgaXMgaW1wb3J0YW50IGJlY2F1c2UgaWYgdGhlIGxpc3QgaGFzIGEgaGVhZGVyLCB0aGUgaW5pdGlhbCBjZWxsXG4gICAgICAgIC8vIHdpbGwgaGF2ZSBhIGxhcmdlciBvZmZzZXQgdGhhdCB3ZSBzaG91bGQgdGFrZSBpbnRvIGFjY291bnQgaGVyZS5cbiAgICAgICAgY29uc3QgaGlnaGVzdE1lYXN1cmVkQ2VsbEZyYW1lID0gdGhpcy5nZXRDZWxsTWV0cmljcyhcbiAgICAgICAgICBoaWdoZXN0TWVhc3VyZWRDZWxsSW5kZXgsXG4gICAgICAgICAgcHJvcHMsXG4gICAgICAgICk7XG4gICAgICAgIGlmIChoaWdoZXN0TWVhc3VyZWRDZWxsRnJhbWUpIHtcbiAgICAgICAgICBvZmZzZXQgPVxuICAgICAgICAgICAgaGlnaGVzdE1lYXN1cmVkQ2VsbEZyYW1lLm9mZnNldCArXG4gICAgICAgICAgICBoaWdoZXN0TWVhc3VyZWRDZWxsRnJhbWUubGVuZ3RoICtcbiAgICAgICAgICAgIHRoaXMuX2F2ZXJhZ2VDZWxsTGVuZ3RoICogKGluZGV4IC0gaGlnaGVzdE1lYXN1cmVkQ2VsbEluZGV4IC0gMSk7XG4gICAgICAgIH1cbiAgICAgIH1cblxuICAgICAgaWYgKG9mZnNldCA9PSBudWxsKSB7XG4gICAgICAgIG9mZnNldCA9IHRoaXMuX2F2ZXJhZ2VDZWxsTGVuZ3RoICogaW5kZXg7XG4gICAgICB9XG5cbiAgICAgIGNvbnN0IHtkYXRhLCBnZXRJdGVtQ291bnR9ID0gcHJvcHM7XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIGluZGV4ID49IDAgJiYgaW5kZXggPCBnZXRJdGVtQ291bnQoZGF0YSksXG4gICAgICAgICdUcmllZCB0byBnZXQgZnJhbWUgZm9yIG91dCBvZiByYW5nZSBpbmRleCAnICsgaW5kZXgsXG4gICAgICApO1xuICAgICAgcmV0dXJuIHtcbiAgICAgICAgbGVuZ3RoOiB0aGlzLl9hdmVyYWdlQ2VsbExlbmd0aCxcbiAgICAgICAgb2Zmc2V0LFxuICAgICAgICBpbmRleCxcbiAgICAgICAgaXNNb3VudGVkOiBmYWxzZSxcbiAgICAgIH07XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFJldHVybnMgdGhlIGV4YWN0IG1ldHJpY3Mgb2YgYSBjZWxsIGlmIGl0IGhhcyBhbHJlYWR5IGJlZW4gbGFpZCBvdXRcbiAgICovXG4gIGdldENlbGxNZXRyaWNzKGluZGV4OiBudW1iZXIsIHByb3BzOiBDZWxsTWV0cmljUHJvcHMpOiA/Q2VsbE1ldHJpY3Mge1xuICAgIGNvbnN0IHtkYXRhLCBnZXRJdGVtLCBnZXRJdGVtQ291bnQsIGdldEl0ZW1MYXlvdXR9ID0gcHJvcHM7XG4gICAgaW52YXJpYW50KFxuICAgICAgaW5kZXggPj0gMCAmJiBpbmRleCA8IGdldEl0ZW1Db3VudChkYXRhKSxcbiAgICAgICdUcmllZCB0byBnZXQgbWV0cmljcyBmb3Igb3V0IG9mIHJhbmdlIGNlbGwgaW5kZXggJyArIGluZGV4LFxuICAgICk7XG4gICAgY29uc3Qga2V5RXh0cmFjdG9yID0gcHJvcHMua2V5RXh0cmFjdG9yID8/IGRlZmF1bHRLZXlFeHRyYWN0b3I7XG4gICAgY29uc3QgZnJhbWUgPSB0aGlzLl9jZWxsTWV0cmljcy5nZXQoXG4gICAgICBrZXlFeHRyYWN0b3IoZ2V0SXRlbShkYXRhLCBpbmRleCksIGluZGV4KSxcbiAgICApO1xuICAgIGlmIChmcmFtZSAmJiBmcmFtZS5pbmRleCA9PT0gaW5kZXgpIHtcbiAgICAgIHJldHVybiBmcmFtZTtcbiAgICB9XG5cbiAgICBpZiAoZ2V0SXRlbUxheW91dCkge1xuICAgICAgY29uc3Qge2xlbmd0aCwgb2Zmc2V0fSA9IGdldEl0ZW1MYXlvdXQoZGF0YSwgaW5kZXgpO1xuICAgICAgLy8gVE9ETzogYGlzTW91bnRlZGAgaXMgdXNlZCBmb3IgYm90aCBcImlzIGV4YWN0IGxheW91dFwiIGFuZCBcImhhcyBiZWVuXG4gICAgICAvLyB1bm1vdW50ZWRcIi4gU2hvdWxkIGJlIHJlZmFjdG9yZWQuXG4gICAgICByZXR1cm4ge2luZGV4LCBsZW5ndGgsIG9mZnNldCwgaXNNb3VudGVkOiB0cnVlfTtcbiAgICB9XG5cbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIC8qKlxuICAgKiBHZXRzIGFuIGFwcHJveGltYXRlIG9mZnNldCB0byBhbiBpdGVtIGF0IGEgZ2l2ZW4gaW5kZXguIFN1cHBvcnRzXG4gICAqIGZyYWN0aW9uYWwgaW5kaWNlcy5cbiAgICovXG4gIGdldENlbGxPZmZzZXRBcHByb3goaW5kZXg6IG51bWJlciwgcHJvcHM6IENlbGxNZXRyaWNQcm9wcyk6IG51bWJlciB7XG4gICAgaWYgKE51bWJlci5pc0ludGVnZXIoaW5kZXgpKSB7XG4gICAgICByZXR1cm4gdGhpcy5nZXRDZWxsTWV0cmljc0FwcHJveChpbmRleCwgcHJvcHMpLm9mZnNldDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgZnJhbWVNZXRyaWNzID0gdGhpcy5nZXRDZWxsTWV0cmljc0FwcHJveChNYXRoLmZsb29yKGluZGV4KSwgcHJvcHMpO1xuICAgICAgY29uc3QgcmVtYWluZGVyID0gaW5kZXggLSBNYXRoLmZsb29yKGluZGV4KTtcbiAgICAgIHJldHVybiBmcmFtZU1ldHJpY3Mub2Zmc2V0ICsgcmVtYWluZGVyICogZnJhbWVNZXRyaWNzLmxlbmd0aDtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmV0dXJucyB0aGUgbGVuZ3RoIG9mIGFsbCBTY3JvbGxWaWV3IGNvbnRlbnQgYWxvbmcgdGhlIHNjcm9sbGluZyBheGlzLlxuICAgKi9cbiAgZ2V0Q29udGVudExlbmd0aCgpOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9jb250ZW50TGVuZ3RoID8/IDA7XG4gIH1cblxuICAvKipcbiAgICogV2hldGhlciBhIGNvbnRlbnQgbGVuZ3RoIGhhcyBiZWVuIG9ic2VydmVkXG4gICAqL1xuICBoYXNDb250ZW50TGVuZ3RoKCk6IGJvb2xlYW4ge1xuICAgIHJldHVybiB0aGlzLl9jb250ZW50TGVuZ3RoICE9IG51bGw7XG4gIH1cblxuICAvKipcbiAgICogRmluZHMgdGhlIGZsb3ctcmVsYXRpdmUgb2Zmc2V0IChlLmcuIHN0YXJ0aW5nIGZyb20gdGhlIGxlZnQgaW4gTFRSLCBidXRcbiAgICogcmlnaHQgaW4gUlRMKSBmcm9tIGEgbGF5b3V0IGJveC5cbiAgICovXG4gIGZsb3dSZWxhdGl2ZU9mZnNldChcbiAgICBsYXlvdXQ6IExheW91dFJlY3RhbmdsZSxcbiAgICByZWZlcmVuY2VDb250ZW50TGVuZ3RoPzogP251bWJlcixcbiAgKTogbnVtYmVyIHtcbiAgICBjb25zdCB7aG9yaXpvbnRhbCwgcnRsfSA9IHRoaXMuX29yaWVudGF0aW9uO1xuXG4gICAgaWYgKGhvcml6b250YWwgJiYgcnRsKSB7XG4gICAgICBjb25zdCBjb250ZW50TGVuZ3RoID0gcmVmZXJlbmNlQ29udGVudExlbmd0aCA/PyB0aGlzLl9jb250ZW50TGVuZ3RoO1xuICAgICAgaW52YXJpYW50KFxuICAgICAgICBjb250ZW50TGVuZ3RoICE9IG51bGwsXG4gICAgICAgICdMaXN0TWV0cmljc0FnZ3JlZ2F0b3IgbXVzdCBiZSBub3RpZmllZCBvZiBsaXN0IGNvbnRlbnQgbGF5b3V0IGJlZm9yZSByZXNvbHZpbmcgb2Zmc2V0cycsXG4gICAgICApO1xuICAgICAgcmV0dXJuIChcbiAgICAgICAgY29udGVudExlbmd0aCAtXG4gICAgICAgICh0aGlzLl9zZWxlY3RPZmZzZXQobGF5b3V0KSArIHRoaXMuX3NlbGVjdExlbmd0aChsYXlvdXQpKVxuICAgICAgKTtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIHRoaXMuX3NlbGVjdE9mZnNldChsYXlvdXQpO1xuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBDb252ZXJ0cyBhIGZsb3ctcmVsYXRpdmUgb2Zmc2V0IHRvIGEgY2FydGVzaWFuIG9mZnNldFxuICAgKi9cbiAgY2FydGVzaWFuT2Zmc2V0KGZsb3dSZWxhdGl2ZU9mZnNldDogbnVtYmVyKTogbnVtYmVyIHtcbiAgICBjb25zdCB7aG9yaXpvbnRhbCwgcnRsfSA9IHRoaXMuX29yaWVudGF0aW9uO1xuXG4gICAgaWYgKGhvcml6b250YWwgJiYgcnRsKSB7XG4gICAgICBpbnZhcmlhbnQoXG4gICAgICAgIHRoaXMuX2NvbnRlbnRMZW5ndGggIT0gbnVsbCxcbiAgICAgICAgJ0xpc3RNZXRyaWNzQWdncmVnYXRvciBtdXN0IGJlIG5vdGlmaWVkIG9mIGxpc3QgY29udGVudCBsYXlvdXQgYmVmb3JlIHJlc29sdmluZyBvZmZzZXRzJyxcbiAgICAgICk7XG4gICAgICByZXR1cm4gdGhpcy5fY29udGVudExlbmd0aCAtIGZsb3dSZWxhdGl2ZU9mZnNldDtcbiAgICB9IGVsc2Uge1xuICAgICAgcmV0dXJuIGZsb3dSZWxhdGl2ZU9mZnNldDtcbiAgICB9XG4gIH1cblxuICBfaW52YWxpZGF0ZUlmT3JpZW50YXRpb25DaGFuZ2VkKG9yaWVudGF0aW9uOiBMaXN0T3JpZW50YXRpb24pOiB2b2lkIHtcbiAgICBpZiAob3JpZW50YXRpb24ucnRsICE9PSB0aGlzLl9vcmllbnRhdGlvbi5ydGwpIHtcbiAgICAgIHRoaXMuX2NlbGxNZXRyaWNzLmNsZWFyKCk7XG4gICAgfVxuXG4gICAgaWYgKG9yaWVudGF0aW9uLmhvcml6b250YWwgIT09IHRoaXMuX29yaWVudGF0aW9uLmhvcml6b250YWwpIHtcbiAgICAgIHRoaXMuX2F2ZXJhZ2VDZWxsTGVuZ3RoID0gMDtcbiAgICAgIHRoaXMuX2hpZ2hlc3RNZWFzdXJlZENlbGxJbmRleCA9IDA7XG4gICAgICB0aGlzLl9tZWFzdXJlZENlbGxzTGVuZ3RoID0gMDtcbiAgICAgIHRoaXMuX21lYXN1cmVkQ2VsbHNDb3VudCA9IDA7XG4gICAgfVxuXG4gICAgdGhpcy5fb3JpZW50YXRpb24gPSBvcmllbnRhdGlvbjtcbiAgfVxuXG4gIF9zZWxlY3RMZW5ndGgoe1xuICAgIHdpZHRoLFxuICAgIGhlaWdodCxcbiAgfTogJFJlYWRPbmx5PHt3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlciwgLi4ufT4pOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9vcmllbnRhdGlvbi5ob3Jpem9udGFsID8gd2lkdGggOiBoZWlnaHQ7XG4gIH1cblxuICBfc2VsZWN0T2Zmc2V0KHt4LCB5fTogJFJlYWRPbmx5PHt4OiBudW1iZXIsIHk6IG51bWJlciwgLi4ufT4pOiBudW1iZXIge1xuICAgIHJldHVybiB0aGlzLl9vcmllbnRhdGlvbi5ob3Jpem9udGFsID8geCA6IHk7XG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQWFBLElBQUFBLGdCQUFBLEdBQUFDLE9BQUE7QUFDQSxJQUFBQyxVQUFBLEdBQUFDLHNCQUFBLENBQUFGLE9BQUE7QUFBa0MsSUE0Q2JHLHFCQUFxQixHQUFBQyxPQUFBLENBQUFDLE9BQUE7RUFBQSxTQUFBRixzQkFBQTtJQUFBLElBQUFHLGdCQUFBLENBQUFELE9BQUEsUUFBQUYscUJBQUE7SUFBQSxLQUN4Q0ksa0JBQWtCLEdBQUcsQ0FBQztJQUFBLEtBQ3RCQyxZQUFZLEdBQTZCLElBQUlDLEdBQUcsQ0FBQyxDQUFDO0lBQUEsS0FFbERDLHlCQUF5QixHQUFHLENBQUM7SUFBQSxLQUM3QkMsb0JBQW9CLEdBQUcsQ0FBQztJQUFBLEtBQ3hCQyxtQkFBbUIsR0FBRyxDQUFDO0lBQUEsS0FDdkJDLFlBQVksR0FBb0I7TUFDOUJDLFVBQVUsRUFBRSxLQUFLO01BQ2pCQyxHQUFHLEVBQUU7SUFDUCxDQUFDO0VBQUE7RUFBQSxXQUFBQyxhQUFBLENBQUFYLE9BQUEsRUFBQUYscUJBQUE7SUFBQWMsR0FBQTtJQUFBQyxLQUFBLEVBT0QsU0FBQUMsZ0JBQWdCQSxDQUFBQyxJQUFBLEVBVUo7TUFBQSxJQVRWQyxTQUFTLEdBQUFELElBQUEsQ0FBVEMsU0FBUztRQUNUQyxPQUFPLEdBQUFGLElBQUEsQ0FBUEUsT0FBTztRQUNQQyxXQUFXLEdBQUFILElBQUEsQ0FBWEcsV0FBVztRQUNYQyxNQUFNLEdBQUFKLElBQUEsQ0FBTkksTUFBTTtNQU9OLElBQUksQ0FBQ0MsK0JBQStCLENBQUNGLFdBQVcsQ0FBQztNQUVqRCxJQUFNRyxJQUFpQixHQUFHO1FBQ3hCQyxLQUFLLEVBQUVOLFNBQVM7UUFDaEJPLE1BQU0sRUFB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