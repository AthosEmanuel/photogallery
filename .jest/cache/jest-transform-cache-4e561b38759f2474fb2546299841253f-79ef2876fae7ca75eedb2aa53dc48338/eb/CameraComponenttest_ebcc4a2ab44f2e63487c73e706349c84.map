{"version":3,"names":["_getJestObj","mock","getCurrentPosition","jest","fn","launchCamera","_interopRequireDefault","require","_asyncToGenerator2","ImagePicker","_interopRequireWildcard","_reactNative","_reactNative2","_geolocation","_react","_components","_jsxRuntime","e","t","WeakMap","r","n","__esModule","o","i","f","__proto__","default","has","get","set","_t","hasOwnProperty","call","Object","defineProperty","getOwnPropertyDescriptor","_require","spyOn","Alert","describe","beforeEach","clearAllMocks","it","Platform","OS","PermissionsAndroid","mockResolvedValue","RESULTS","DENIED","onCloseMock","render","jsx","CameraComponent","onClose","waitFor","expect","toHaveBeenCalled","alert","toHaveBeenCalledWith","GRANTED","Geolocation","mockImplementation","success","coords","latitude","longitude","_options","callback","assets","uri","onPhotoTakenMock","onPhotoTaken","didCancel","errorCode","errorMessage","_success","error","message","undefined"],"sources":["CameraComponent.test.tsx"],"sourcesContent":["import * as ImagePicker from 'react-native-image-picker';\n\nimport { render, waitFor } from '@testing-library/react-native';\nimport { Alert, PermissionsAndroid, Platform } from 'react-native';\n\nimport Geolocation from '@react-native-community/geolocation';\nimport React from 'react';\nimport { CameraComponent } from '../src/components/';\n\n// --- Mocks ---\n// Mock do Geolocation\njest.mock('@react-native-community/geolocation', () => ({\n  getCurrentPosition: jest.fn(),\n}));\n\n// Mock do launchCamera\njest.mock('react-native-image-picker', () => ({\n  launchCamera: jest.fn(),\n}));\n\n// Mock do Alert para não abrir popups\njest.spyOn(Alert, 'alert');\n\ndescribe('CameraComponent', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  it('should call onClose if camera permission is denied (Android)', async () => {\n    if (Platform.OS === 'android') {\n      jest\n        .spyOn(PermissionsAndroid, 'request')\n        .mockResolvedValue(PermissionsAndroid.RESULTS.DENIED);\n\n      const onCloseMock = jest.fn();\n      render(<CameraComponent onClose={onCloseMock} />);\n      await waitFor(() => expect(onCloseMock).toHaveBeenCalled());\n      expect(Alert.alert).toHaveBeenCalledWith(\n        'Permissão negada',\n        'Não será possível usar a câmera',\n      );\n    }\n  });\n\n  it('should call onPhotoTaken and onClose when photo is taken (Android/iOS)', async () => {\n    // Permissão concedida\n    if (Platform.OS === 'android') {\n      jest\n        .spyOn(PermissionsAndroid, 'request')\n        .mockResolvedValue(PermissionsAndroid.RESULTS.GRANTED);\n    }\n\n    // Mock Geolocation\n    (Geolocation.getCurrentPosition as jest.Mock).mockImplementation(\n      (success: any) => success({ coords: { latitude: 10, longitude: 20 } }),\n    );\n\n    // Mock câmera\n    (ImagePicker.launchCamera as jest.Mock).mockImplementation(\n      (_options, callback) =>\n        callback({\n          assets: [{ uri: 'photo-uri' }],\n        }),\n    );\n\n    const onPhotoTakenMock = jest.fn();\n    const onCloseMock = jest.fn();\n\n    render(\n      <CameraComponent onPhotoTaken={onPhotoTakenMock} onClose={onCloseMock} />,\n    );\n\n    await waitFor(() =>\n      expect(onPhotoTakenMock).toHaveBeenCalledWith('photo-uri', {\n        latitude: 10,\n        longitude: 20,\n      }),\n    );\n    await waitFor(() => expect(onCloseMock).toHaveBeenCalled());\n  });\n\n  it('should call onClose if user cancels the camera', async () => {\n    if (Platform.OS === 'android') {\n      jest\n        .spyOn(PermissionsAndroid, 'request')\n        .mockResolvedValue(PermissionsAndroid.RESULTS.GRANTED);\n    }\n\n    (Geolocation.getCurrentPosition as jest.Mock).mockImplementation(\n      (success: any) => success({ coords: { latitude: 0, longitude: 0 } }),\n    );\n\n    (ImagePicker.launchCamera as jest.Mock).mockImplementation(\n      (_options, callback) => callback({ didCancel: true }),\n    );\n\n    const onCloseMock = jest.fn();\n    render(<CameraComponent onClose={onCloseMock} />);\n    await waitFor(() => expect(onCloseMock).toHaveBeenCalled());\n  });\n\n  it('should show alert if camera returns an error', async () => {\n    if (Platform.OS === 'android') {\n      jest\n        .spyOn(PermissionsAndroid, 'request')\n        .mockResolvedValue(PermissionsAndroid.RESULTS.GRANTED);\n    }\n\n    (Geolocation.getCurrentPosition as jest.Mock).mockImplementation(\n      (success: any) => success({ coords: { latitude: 0, longitude: 0 } }),\n    );\n\n    (ImagePicker.launchCamera as jest.Mock).mockImplementation(\n      (_options, callback) =>\n        callback({ errorCode: 'ERROR', errorMessage: 'Camera error' }),\n    );\n\n    render(<CameraComponent onClose={jest.fn()} />);\n    await waitFor(() =>\n      expect(Alert.alert).toHaveBeenCalledWith('Erro', 'Camera error'),\n    );\n  });\n\n  it('should handle geolocation error gracefully', async () => {\n    if (Platform.OS === 'android') {\n      jest\n        .spyOn(PermissionsAndroid, 'request')\n        .mockResolvedValue(PermissionsAndroid.RESULTS.GRANTED);\n    }\n\n    // Geolocation falha\n    (Geolocation.getCurrentPosition as jest.Mock).mockImplementation(\n      (_success, error) => error({ message: 'Location error' }),\n    );\n\n    (ImagePicker.launchCamera as jest.Mock).mockImplementation(\n      (_options, callback) => callback({ assets: [{ uri: 'photo-uri' }] }),\n    );\n\n    const onPhotoTakenMock = jest.fn();\n    render(<CameraComponent onPhotoTaken={onPhotoTakenMock} />);\n    await waitFor(() =>\n      expect(onPhotoTakenMock).toHaveBeenCalledWith('photo-uri', undefined),\n    );\n  });\n});\n"],"mappings":"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","ignoreList":[]}